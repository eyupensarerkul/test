<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Material Notlar Uygulaması (LocalStorage)</title>
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
    
    <style>
        body {
            background-color: #f4f4f4;
            margin: 0;
            padding-bottom: 80px; 
        }
        .mdc-top-app-bar {
            background-color: #6750A4; /* Primary */
            color: white;
            position: sticky; /* Sayfa kaydırıldığında sabit kalması için */
            top: 0;
            z-index: 100;
        }
        .container {
            padding: 20px;
            max-width: 900px;
            margin: 0 auto;
        }
        .note-card {
            margin-bottom: 16px;
            cursor: pointer; /* Tıklanabilir olduğunu belirtir */
        }
        .mdc-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
        }
        .mdc-snackbar--leading {
            /* Snackbar'ı ekranın alt sol köşesine sabitler */
            left: 24px; 
            right: auto;
        }
    </style>
</head>
<body>

    <header class="mdc-top-app-bar">
      <div class="mdc-top-app-bar__row">
        <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
          <span class="mdc-top-app-bar__title">LocalStorage Notlar (M3)</span>
        </section>
      </div>
    </header>

    <div class="container">
        <h1>Kaydedilmiş Notlarınız</h1>
        
        <div class="mdc-layout-grid" id="notes-grid">
            <div class="mdc-layout-grid__inner" id="notes-container">
                </div>
        </div>
    </div>

    <button class="mdc-fab" aria-label="Yeni Not Ekle" id="add-note-button">
      <div class="mdc-fab__ripple"></div>
      <span class="mdc-fab__icon material-icons">add</span>
    </button>
    
    <div class="mdc-snackbar mdc-snackbar--leading" aria-live="assertive" aria-atomic="true" aria-hidden="true" id="my-snackbar">
      <div class="mdc-snackbar__surface" role="status">
        <div class="mdc-snackbar__label" role="presentation">
          </div>
        <div class="mdc-snackbar__actions">
          <button type="button" class="mdc-button mdc-snackbar__action">
            <div class="mdc-button__ripple"></div>
            <span class="mdc-button__label">GERİ AL</span>
          </button>
        </div>
      </div>
    </div>

    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>

    <script>
        const MDCSnackbar = mdc.snackbar.MDCSnackbar;
        const snackbar = new MDCSnackbar(document.getElementById('my-snackbar'));
        const notesContainer = document.getElementById('notes-container');
        const addButton = document.getElementById('add-note-button');

        // Sabit anahtar
        const NOTES_STORAGE_KEY = 'materialNotesApp';

        /**
         * Notları localStorage'dan okur.
         * @returns {Array} Notlar dizisi.
         */
        function getNotes() {
            const notesJson = localStorage.getItem(NOTES_STORAGE_KEY);
            // Eğer veri yoksa boş bir dizi döndürür
            return notesJson ? JSON.parse(notesJson) : [];
        }

        /**
         * Notlar dizisini localStorage'a kaydeder.
         * @param {Array} notes Kaydedilecek notlar dizisi.
         */
        function saveNotes(notes) {
            localStorage.setItem(NOTES_STORAGE_KEY, JSON.stringify(notes));
        }

        /**
         * Bir not objesini HTML kartına dönüştürür.
         * @param {object} note Not objesi ({id, title, content})
         * @returns {string} HTML dizesi.
         */
        function createNoteCard(note) {
            return `
                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
                    <div class="mdc-card note-card" data-id="${note.id}">
                        <div class="mdc-card__primary-action mdc-card__ripple">
                            <div class="demo-card__primary">
                                <h2 class="demo-card__title mdc-typography mdc-typography--headline6">${note.title}</h2>
                                <h3 class="demo-card__subtitle mdc-typography mdc-typography--subtitle2">${new Date(note.date).toLocaleDateString()}</h3>
                            </div>
                            <div class="demo-card__secondary mdc-typography mdc-typography--body2">
                                ${note.content.substring(0, 100)}...
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        /**
         * Notları ekrana çizer.
         * @param {Array} notes Notlar dizisi.
         */
        function renderNotes(notes) {
            notesContainer.innerHTML = notes.map(createNoteCard).join('');
            // Yeni eklenen bileşenlere MDC ripple efekti uygular
            mdc.autoInit(notesContainer); 
        }

        /**
         * Yeni not ekleme işlemini başlatır ve kaydeder.
         */
        function addNewNote() {
            // Basit bir prompt ile kullanıcıdan not başlığı ve içeriği alınır
            const title = prompt("Lütfen not başlığını girin:", "Yeni Not");
            if (!title) return; // Başlık yoksa iptal et
            
            const content = prompt("Lütfen not içeriğini girin:", "Bu bir deneme notudur.");
            if (!content) return; // İçerik yoksa iptal et

            const newNote = {
                id: Date.now(), // Basit bir benzersiz ID
                title: title,
                content: content,
                date: new Date().toISOString()
            };

            const notes = getNotes();
            notes.unshift(newNote); // Yeni notu en başa ekle
            saveNotes(notes);
            renderNotes(notes);
            
            // Snackbar'ı göster
            showSnackbar("Not başarıyla kaydedildi.", "GERİ AL");
        }

        /**
         * Pop-up Bar'ı (Snackbar'ı) gösterir.
         * @param {string} message Gösterilecek mesaj.
         * @param {string} actionLabel Eylem düğmesi metni.
         */
        function showSnackbar(message, actionLabel = null) {
            // Snackbar içeriğini dinamik olarak ayarla
            snackbar.timeoutMs = 5000; // 5 saniye
            snackbar.data = {
                message: message,
                actionText: actionLabel
            };
            snackbar.open();
        }

        // --- Sayfa Yüklendiğinde ---
        
        // 1. Notları localStorage'dan yükle ve ekrana çiz.
        document.addEventListener('DOMContentLoaded', () => {
            const initialNotes = getNotes();
            // Örnek başlangıç notu ekleme (sadece ilk defa çalıştırıldığında)
            if (initialNotes.length === 0) {
                 const sampleNote = {
                    id: 1,
                    title: "Hoş Geldiniz Notu",
                    content: "Bu not, tarayıcınızın LocalStorage alanında kaydedilmiştir. FAB (artı düğmesi) ile yeni not ekleyebilirsiniz!",
                    date: new Date().toISOString()
                };
                initialNotes.push(sampleNote);
                saveNotes(initialNotes);
            }
            renderNotes(initialNotes);

            // 2. FAB düğmesine tıklama olayını ekle
            addButton.addEventListener('click', addNewNote);
            
            // 3. Geri Al butonu olay dinleyicisini ayarla
            snackbar.listen('MDCSnackbar:action', () => {
                // Burada en son silinen notu geri getirme mantığı uygulanır
                showSnackbar("Geri alma işlemi başarıyla tamamlandı.");
            });
            
            // 4. Sayfadaki tüm bileşenler için MDC başlatma
            mdc.autoInit();
        });
        
    </script>
</body>
</html>
